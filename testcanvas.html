<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Konva Layout Starter — ES Modules</title>
    <style>
      :root {
        --bg: #0b0d0f;
        --fg: #cfe3d0;
        --panel: #E6CDAE;
        --border: #273036;
        --header-h: 5vh;
        --left-w: 15vw;
        --right-w: 15vw;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        background: var(--bg);
        color: var(--fg);
      }

      body {
        display: grid;
        grid-template-rows: var(--header-h) 1fr;
        grid-template-columns: 100%;
        height: 100vh;
        font: 14px/1.4 ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
      }

      header {
        grid-row: 1;
        grid-column: 1;
        display: flex;
        align-items: center;
        padding: 0 12px;
        background: #D28140;
        border-bottom: 1px solid var(--border);
      }

      .main {
        grid-row: 2;
        grid-column: 1;
        display: grid;
        grid-template-columns: var(--left-w) 1fr var(--right-w);
        grid-template-rows: 100%;
        min-height: 0;
      }

      .panel {
        min-height: 0;
        min-width: 0;
        border-right: 1px solid var(--border);
        background: var(--panel);
        color: #0b0d0f;
        /* readable on light panel */
      }

      .panel.right {
        border-right: none;
        border-left: 1px solid var(--border);
      }

      .panel.middle {
        position: relative;
        display: grid;
        grid-template-rows: 100%;
        grid-template-columns: 100%;
        overflow: hidden;
        color: inherit;
        background: var(--bg);
        /* keep canvas area dark */
      }

      #konvaMount {
        width: 100%;
        height: 100%;
        display: block;
      }

      .stack {
        padding: 12px;
        display: grid;
        gap: 12px;
      }

      .card {
        background: #f7f1e6;
        border: 1px solid #c7a983;
        border-radius: 8px;
        padding: 10px;
        display: grid;
        gap: 8px;
      }

      .card h3 {
        margin: 0 0 4px;
        font-size: 13px;
        color: #2a2621;
      }

      .row {
        display: grid;
        grid-template-columns: 1fr auto;
        align-items: center;
        gap: 8px;
      }

      .row input[type="color"] {
        width: 40px;
        height: 24px;
        padding: 0;
        border: 0;
        background: none;
      }

      .row input[type="number"],
      .row select {
        width: 140px;
      }

      .row input[readonly] {
        background: #f1e7d7;
        border: 1px solid #c7a983;
        border-radius: 4px;
        padding: 4px 6px;
      }

      .row input[type="checkbox"] {
        transform: translateY(1px);
      }

      .tight {
        display: flex;
        align-items: center;
        gap: 8px;
      }
    </style>
    <!-- noUiSlider (global) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nouislider@15.8.1/dist/nouislider.min.css">
    <script src="https://cdn.jsdelivr.net/npm/nouislider@15.8.1/dist/nouislider.min.js"></script>
  </head>
  <body>
    <header>Header (5% height)</header>
    <div class="main">
      <!-- LEFT: Global settings -->
      <aside class="panel left">
        <div class="stack">
          <div class="card">
            <h3>World</h3>
            <div class="row">
              <label for="worldTopColor">Top</label>
              <input id="worldTopColor" type="color" value="#0f1418">
            </div>
            <div class="row">
              <label for="worldBottomColor">Bottom</label>
              <input id="worldBottomColor" type="color" value="#0b0f13">
            </div>
            <div class="row">
              <label for="worldStrokeColor">Border</label>
              <input id="worldStrokeColor" type="color" value="#2a3238">
            </div>
          </div>
          <div class="card">
            <h3>Grid</h3>
            <div class="row">
              <label for="gridToggle">Show Grid</label>
              <input id="gridToggle" type="checkbox" checked>
            </div>
            <div class="row">
              <label for="gridLightColor">Light</label>
              <input id="gridLightColor" type="color" value="#1c242a">
            </div>
            <div class="row">
              <label for="gridHeavyColor">Heavy</label>
              <input id="gridHeavyColor" type="color" value="#2f3a41">
            </div>
            <div class="row">
              <label for="gridSpacing">Spacing</label>
              <input id="gridSpacing" type="number" min="10" step="10" value="100">
            </div>
            <div class="row">
              <label for="gridMajorEvery">Major Every</label>
              <input id="gridMajorEvery" type="number" min="50" step="50" value="500">
            </div>
          </div>
          <div class="card">
            <h3>Card Shadow (Global)</h3>
            <div class="row">
              <label for="shadowEnabled">Enabled</label>
              <input id="shadowEnabled" type="checkbox" checked>
            </div>
            <div class="row">
              <label for="shadowDx">Offset X</label>
              <input id="shadowDx" type="number" step="1" value="6">
            </div>
            <div class="row">
              <label for="shadowDy">Offset Y</label>
              <input id="shadowDy" type="number" step="1" value="6">
            </div>
            <div class="row">
              <label for="shadowBlur">Blur</label>
              <input id="shadowBlur" type="number" min="0" step="1" value="12">
            </div>
            <div class="row">
              <label for="shadowOpacity">Opacity</label>
              <input id="shadowOpacity" type="number" min="0" max="1" step="0.05" value="0.35">
            </div>
            <div class="row">
              <label for="shadowColor">Color</label>
              <input id="shadowColor" type="color" value="#000000">
            </div>
          </div>
        </div>
      </aside>
      <!-- MIDDLE: Canvas -->
      <section class="panel middle">
        <div id="konvaMount"></div>
      </section>
      <!-- RIGHT: Local controls & selection tracking -->
      <aside class="panel right">
        <div class="stack">
          <div class="card">
            <h3>View</h3>
            <div class="row">
              <button id="recenterBtn" style="padding:8px; border:1px solid #273036; border-radius:6px; background:#dba368; cursor:pointer;"> Recenter (3000,3000) </button>
              <span></span>
            </div>
            <div class="row" style="align-items:center; gap:8px;">
              <div class="tight">
                <button id="zoomMinusBtn" title="Down to next 10%" style="padding:8px 12px; border:1px solid #273036; border-radius:6px; background:#dba368; cursor:pointer;">−</button>
              </div>
              <div id="zoomSlider" style="flex:1; margin:0 2px; min-width: 160px;"></div>
              <div class="tight">
                <button id="zoomPlusBtn" title="Up to next 10% (≤ 490%)" style="padding:8px 12px; border:1px solid #273036; border-radius:6px; background:#dba368; cursor:pointer;">+</button>
              </div>
            </div>
            <div style="text-align:right; opacity:.8;">Zoom: <b id="zoomPct">100%</b>
            </div>
          </div>
          <div class="card">
            <h3>Selection</h3>
            <div class="row">
              <label for="selCard">Card</label>
              <select id="selCard"></select>
            </div>
            <div class="row">
              <label>Status</label>
              <span id="selStatus">idle</span>
            </div>
            <div class="row">
              <label for="selCx">cx</label>
              <input id="selCx" type="number" readonly>
            </div>
            <div class="row">
              <label for="selCy">cy</label>
              <input id="selCy" type="number" readonly>
            </div>
            <div class="row">
              <label for="selW">w</label>
              <input id="selW" type="number" readonly>
            </div>
            <div class="row">
              <label for="selH">h</label>
              <input id="selH" type="number" readonly>
            </div>
            <div class="row">
              <label for="selRot">rot</label>
              <input id="selRot" type="number" readonly>
            </div>
          </div>
        </div>
      </aside>
    </div>
    <!-- App entry (ES module) -->
    <script type="module" src="./src/main.js"></script>
  </body>
</html>
